<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Actividad 4 - Rick & Morty</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-spinner *ngIf="loadingList" class="center-spinner"></ion-spinner>

  <ion-list *ngIf="!loadingList">
    <ion-item button *ngFor="let ep of episodes" (click)="openDetail(ep.id)" class="episode-item">
      <ion-label>
        <h2>{{ ep.name }}</h2>
        <p>{{ ep.episode }} — {{ ep.air_date }}</p>
      </ion-label>
      <ion-icon name="chevron-forward-outline" slot="end"></ion-icon>
    </ion-item>
  </ion-list>

  <ion-modal [isOpen]="isModalOpen" (didDismiss)="closeModal()">
    <ng-template>
      <ion-header>
        <ion-toolbar color="primary">
          <ion-title>Detalles del Episodio</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeModal()">Cerrar</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content class="ion-padding modal-content-dark">
        <ion-spinner *ngIf="loadingDetail" class="center-spinner"></ion-spinner>

        <div *ngIf="selectedEpisode">
          <div class="header-detail">
            <h1>{{ selectedEpisode.name }}</h1>
            <p><strong>Código:</strong> {{ selectedEpisode.episode }}</p>
            <p><strong>Emisión:</strong> {{ selectedEpisode.air_date }}</p>
          </div>

          <h3 class="section-title">Personajes en escena</h3>
          <ion-list lines="none">
            <ion-item *ngFor="let char of selectedEpisode.characters" class="character-card">
              <ion-avatar slot="start">
                <img [src]="char.image" />
              </ion-avatar>
              <ion-label>
                <h2>{{ char.name }}</h2>
                <p [class]="char.status.toLowerCase()">{{ char.status }} — {{ char.species }}</p>
              </ion-label>
            </ion-item>
          </ion-list>
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>