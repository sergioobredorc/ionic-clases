<ion-content class="ion-padding">

  <ion-button expand="block" (click)="requestPermissions()">
    Solicitar permisos
  </ion-button>

  <p>Cámara: {{ cameraGranted ? 'Concedido' : 'Denegado' }}</p>
  <p>Micrófono: {{ micGranted ? 'Concedido' : 'Denegado' }}</p>

  <ion-button
    expand="block"
    color="secondary"
    (click)="takePhoto()"
    *ngIf="cameraGranted">
    Tomar foto
  </ion-button>

  <ion-button
    expand="block"
    color="tertiary"
    (click)="recordAudio()"
    *ngIf="micGranted">
    Grabar audio (5 segundos)
  </ion-button>

  <audio
    *ngIf="audioURL"
    [src]="audioURL"
    controls
    style="margin-top: 10px; width: 100%;">
  </audio>

  <ion-item>
    <ion-input
      placeholder="Descripción de la captura"
      [(ngModel)]="text">
    </ion-input>
  </ion-item>

  <ion-button expand="block" (click)="analyzeText()">
    Analizar texto
  </ion-button>

  <ion-spinner *ngIf="loading"></ion-spinner>

  <div *ngIf="sentimentResult">
    <p>Resultado: {{ sentimentResult.label }}</p>
    <p>Confianza: {{ sentimentResult.score | number:'1.2-2' }}</p>
  </div>

  <video
    #video
    autoplay
    playsinline
    style="
      margin-top: 10px;
      border-radius: 8px;
      width: 100%;
      max-height: 220px;
      background: black;
    ">
  </video>

  <img
    *ngIf="photo"
    [src]="photo"
    style="margin-top: 10px; width: 100%; border-radius: 8px;" />

</ion-content>
